<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Job History</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; font-family: "Segoe UI", sans-serif; }

body {
    margin: 0;
    background: #f4f6fb;
}

/* HEADER */
.header {
    padding: 20px 30px;
    font-size: 24px;
    font-weight: bold;
    color: #333;
}

/* CARD */
.card {
    margin: 0 30px;
    background: #E5E8FF;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 4px rgba(0,0,0,0.25);
}

/* SEARCH */
.search-bar {
    display: flex;
    justify-content: space-between;
    margin-bottom: 15px;
}

.search-bar input {
    width: 100%;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
}

.filter-btn {
    margin-left: 10px;
    padding: 10px 14px;
    background: #5a5cff;
    color: #fff;
    border-radius: 6px;
    cursor: pointer;
}

/* FILTER POPUP */
.filter-box {
    position: absolute;
    right: 40px;
    top: 160px;
    width: 220px;
    background: #fff;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    display: none;
}

.filter-box label {
    font-size: 12px;
    font-weight: bold;
}

.filter-box input {
    width: 100%;
    margin: 6px 0 10px;
    padding: 6px;
}

.filter-actions {
    display: flex;
    justify-content: space-between;
}

.filter-actions button {
    padding: 6px 10px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.apply { background:#5a5cff;color:#fff;}
.reset { background:#eee; }

/* TABLE */
table {
    width: 100%;
    border-collapse: collapse;
    background: white;
}

th {
    background: #D0D4F2;
    padding: 12px;
    text-align: left;
}

td {
    padding: 12px;
}

tr:nth-child(even) { background: #fff; }
tr:nth-child(odd) { background: #F7F6FE; }

.no-data {
    text-align: center;
    padding: 20px;
}

/* INVOICE BUTTON */
.pdf-btn {
    background: #ff5252;
    color: white;
    border: none;
    padding: 6px 10px;
    border-radius: 5px;
    cursor: pointer;
}

/* PAGINATION */
.pagination {
    margin-top: 10px;
    display: flex;
    justify-content: space-between;
    font-size: 14px;
}

/* MODAL */
.modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    display: none;
    justify-content: center;
    align-items: center;
}

.modal-box {
    background: #fff;
    padding: 20px;
    width: 300px;
    border-radius: 10px;
}

.modal-box h3 {
    margin-top: 0;
}

.modal-box button {
    margin-top: 10px;
    width: 100%;
    padding: 8px;
    border: none;
    border-radius: 6px;
    background: #5a5cff;
    color: white;
}
</style>
</head>

<body>

<div class="header">History</div>

<div class="card">

    <div class="search-bar">
        <input id="search" placeholder="Search by date or amount...">
        <div class="filter-btn" onclick="toggleFilter()">Filter</div>
    </div>

    <div class="filter-box" id="filterBox">
        <label>Arrival Date</label>
        <input type="date" id="arrivalFilter">
        <label>Delivery Date</label>
        <input type="date" id="deliveryFilter">
        <div class="filter-actions">
            <button class="reset" onclick="resetFilter()">Reset</button>
            <button class="apply" onclick="applyFilter()">Apply</button>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th>Arrival Date</th>
                <th>Delivery Date</th>
                <th>Total Hours</th>
                <th>Total Amount</th>
                <th>Invoice</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>

    <div class="pagination" id="pagination"></div>
</div>

<!-- MODAL -->
<div class="modal" id="invoiceModal">
    <div class="modal-box">
        <h3>Select Invoice Date</h3>
        <input type="date" id="invoiceDate">
        <button onclick="confirmInvoice()">Generate Invoice</button>
    </div>
</div>

<script>
const data = [
    {id:1, arrival:"2025-10-13", delivery:"2025-10-14", hours:4.5, amount:1200},
    {id:2, arrival:"2025-10-15", delivery:"2025-10-17", hours:6.25, amount:1800},
    {id:3, arrival:"2025-10-18", delivery:"2025-10-19", hours:3.75, amount:950}
];

let filtered = [...data];
let selectedJob = null;

function formatDate(d){ return new Date(d).toLocaleDateString("en-GB"); }
function formatMoney(v){ return new Intl.NumberFormat("en-US",{minimumFractionDigits:2}).format(v); }

function render() {
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";
    if (!filtered.length) {
        tbody.innerHTML = `<tr><td colspan="5" class="no-data">No records found</td></tr>`;
        return;
    }
    filtered.forEach(r=>{
        tbody.innerHTML += `
        <tr>
            <td>${formatDate(r.arrival)}</td>
            <td>${formatDate(r.delivery)}</td>
            <td>${r.hours.toFixed(2)}</td>
            <td>${formatMoney(r.amount)}</td>
            <td><button class="pdf-btn" onclick="openInvoice(${r.id})">PDF</button></td>
        </tr>`;
    });
}

function toggleFilter(){
    const f = document.getElementById("filterBox");
    f.style.display = f.style.display === "block" ? "none" : "block";
}

function applyFilter(){
    const a = document.getElementById("arrivalFilter").value;
    const d = document.getElementById("deliveryFilter").value;

    filtered = data.filter(x =>
        (!a || x.arrival === a) &&
        (!d || x.delivery === d)
    );
    render();
}

function resetFilter(){
    document.getElementById("arrivalFilter").value = "";
    document.getElementById("deliveryFilter").value = "";
    filtered = [...data];
    render();
}

function openInvoice(id){
    selectedJob = id;
    document.getElementById("invoiceModal").style.display = "flex";
}

function confirmInvoice(){
    const date = document.getElementById("invoiceDate").value;
    if(!date){
        alert("Please select invoice date");
        return;
    }
    alert("Invoice generated for Job ID " + selectedJob + " on " + date);
    document.getElementById("invoiceModal").style.display = "none";
}

window.onclick = e => {
    if(e.target.classList.contains("modal")){
        e.target.style.display="none";
    }
}

render();
</script>
</body>
</html>

