<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Job History</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
* { box-sizing: border-box; font-family: "Segoe UI", sans-serif; }
body { margin: 0; background: #f4f6fb; }

.header {
    padding: 20px 30px;
    font-size: 24px;
    font-weight: bold;
}

.card {
    margin: 0 30px;
    background: #E5E8FF;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 4px 4px rgba(0,0,0,0.25);
}

.search-bar {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.search-bar input {
    flex: 1;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
}

.filter-btn {
    padding: 10px 14px;
    background: #5a5cff;
    color: white;
    border-radius: 6px;
    cursor: pointer;
}

.filter-box {
    position: absolute;
    right: 40px;
    top: 160px;
    width: 220px;
    background: white;
    padding: 15px;
    border-radius: 8px;
    display: none;
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

.filter-box label { font-size: 12px; font-weight: bold; }
.filter-box input { width: 100%; margin-bottom: 10px; padding: 6px; }

.filter-actions {
    display: flex;
    justify-content: space-between;
}

.filter-actions button {
    padding: 6px 10px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.apply { background: #5a5cff; color: white; }
.reset { background: #eee; }

table {
    width: 100%;
    border-collapse: collapse;
    background: white;
}

th {
    background: #D0D4F2;
    padding: 12px;
    text-align: left;
}

td { padding: 12px; }

tr:nth-child(even){ background: #fff; }
tr:nth-child(odd){ background: #F7F6FE; }

.no-data { text-align: center; padding: 20px; }

.pdf-btn {
    background: #ff5252;
    color: white;
    border: none;
    padding: 6px 10px;
    border-radius: 5px;
    cursor: pointer;
}

/* PAGINATION */
.pagination {
    margin-top: 15px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
}

.pagination select { padding: 5px; }

.pagination button {
    padding: 5px 10px;
    background: #5a5cff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.pagination button:disabled {
    background: #aaa;
    cursor: not-allowed;
}

/* MODAL */
.modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    display: none;
    justify-content: center;
    align-items: center;
}

.modal-box {
    background: white;
    padding: 20px;
    width: 300px;
    border-radius: 10px;
}

.modal-box button {
    margin-top: 10px;
    width: 100%;
    padding: 8px;
    background: #5a5cff;
    color: white;
    border: none;
    border-radius: 6px;
}
</style>
</head>

<body>

<div class="header">History</div>

<div class="card">

    <div class="search-bar">
        <input id="search" placeholder="Search by date or amount...">
        <div class="filter-btn" onclick="toggleFilter()">Filter</div>
    </div>

    <div class="filter-box" id="filterBox">
        <label>Arrival Date</label>
        <input type="date" id="arrivalFilter">
        <label>Delivery Date</label>
        <input type="date" id="deliveryFilter">
        <div class="filter-actions">
            <button class="reset" onclick="resetFilter()">Reset</button>
            <button class="apply" onclick="applyFilter()">Apply</button>
        </div>
    </div>

    <table>
        <thead>
            <tr>
                <th>Arrival Date</th>
                <th>Delivery Date</th>
                <th>Total Hours</th>
                <th>Total Amount</th>
                <th>Invoice</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>

    <div class="pagination">
        <div>
            Rows per page:
            <select id="rowsPerPage">
                <option>5</option>
                <option selected>10</option>
                <option>20</option>
            </select>
        </div>

        <div id="pageInfo"></div>

        <div>
            <button id="prevBtn">Previous</button>
            <button id="nextBtn">Next</button>
        </div>
    </div>
</div>

<!-- INVOICE MODAL -->
<div class="modal" id="invoiceModal">
    <div class="modal-box">
        <h3>Select Invoice Date</h3>
        <input type="date" id="invoiceDate">
        <button onclick="confirmInvoice()">Generate Invoice</button>
    </div>
</div>

<script>
const data = [

 {id:1, arrival:"2025-10-01", delivery:"2025-10-02", hours:4.5, amount:1200},
 {id:2, arrival:"2025-10-03", delivery:"2025-10-04", hours:6.0, amount:1500},
 {id:3, arrival:"2025-10-05", delivery:"2025-10-06", hours:3.75, amount:950},
 {id:4, arrival:"2025-10-07", delivery:"2025-10-08", hours:7.25, amount:2100},
 {id:5, arrival:"2025-10-09", delivery:"2025-10-10", hours:5.0, amount:1400},
 {id:6, arrival:"2025-10-11", delivery:"2025-10-12", hours:8.0, amount:2400},
 {id:7, arrival:"2025-10-13", delivery:"2025-10-14", hours:4.25, amount:1150},
 {id:8, arrival:"2025-10-15", delivery:"2025-10-16", hours:6.5, amount:1800},
 {id:9, arrival:"2025-10-17", delivery:"2025-10-18", hours:3.5, amount:900},
 {id:10, arrival:"2025-10-19", delivery:"2025-10-20", hours:7.75, amount:2300},

 {id:11, arrival:"2025-10-21", delivery:"2025-10-22", hours:5.25, amount:1600},
 {id:12, arrival:"2025-10-23", delivery:"2025-10-24", hours:6.75, amount:1950},
 {id:13, arrival:"2025-10-25", delivery:"2025-10-26", hours:4.0, amount:1100},
 {id:14, arrival:"2025-10-27", delivery:"2025-10-28", hours:8.5, amount:2600},
 {id:15, arrival:"2025-10-29", delivery:"2025-10-30", hours:5.5, amount:1550},

 {id:16, arrival:"2025-11-01", delivery:"2025-11-02", hours:6.25, amount:1850},
 {id:17, arrival:"2025-11-03", delivery:"2025-11-04", hours:3.75, amount:1000},
 {id:18, arrival:"2025-11-05", delivery:"2025-11-06", hours:7.0, amount:2150},
 {id:19, arrival:"2025-11-07", delivery:"2025-11-08", hours:5.0, amount:1450},
 {id:20, arrival:"2025-11-09", delivery:"2025-11-10", hours:8.25, amount:2500},

 {id:21, arrival:"2025-11-11", delivery:"2025-11-12", hours:4.5, amount:1200},
 {id:22, arrival:"2025-11-13", delivery:"2025-11-14", hours:6.0, amount:1700},
 {id:23, arrival:"2025-11-15", delivery:"2025-11-16", hours:3.25, amount:850},
 {id:24, arrival:"2025-11-17", delivery:"2025-11-18", hours:7.5, amount:2250},
 {id:25, arrival:"2025-11-19", delivery:"2025-11-20", hours:5.75, amount:1650},

 {id:26, arrival:"2025-11-21", delivery:"2025-11-22", hours:6.5, amount:1900},
 {id:27, arrival:"2025-11-23", delivery:"2025-11-24", hours:4.0, amount:1100},
 {id:28, arrival:"2025-11-25", delivery:"2025-11-26", hours:8.0, amount:2400},
 {id:29, arrival:"2025-11-27", delivery:"2025-11-28", hours:5.25, amount:1500},
 {id:30, arrival:"2025-11-29", delivery:"2025-11-30", hours:7.75, amount:2350},

 {id:31, arrival:"2025-12-01", delivery:"2025-12-02", hours:6.0, amount:1750},
 {id:32, arrival:"2025-12-03", delivery:"2025-12-04", hours:3.5, amount:900},
 {id:33, arrival:"2025-12-05", delivery:"2025-12-06", hours:8.25, amount:2550},
 {id:34, arrival:"2025-12-07", delivery:"2025-12-08", hours:5.0, amount:1400},
 {id:35, arrival:"2025-12-09", delivery:"2025-12-10", hours:6.75, amount:2000}

];

let filtered = [...data];
let page = 1;
let rowsPerPage = 10;
let selectedJob = null;

function formatDate(d){ return new Date(d).toLocaleDateString("en-GB"); }

function render(){
    const tbody = document.getElementById("tableBody");
    tbody.innerHTML = "";

    const start = (page - 1) * rowsPerPage;
    const end = start + rowsPerPage;
    const pageData = filtered.slice(start, end);

    if(!pageData.length){
        tbody.innerHTML = `<tr><td colspan="5" class="no-data">No records found</td></tr>`;
        return;
    }

    pageData.forEach(r=>{
        tbody.innerHTML += `
        <tr>
            <td>${formatDate(r.arrival)}</td>
            <td>${formatDate(r.delivery)}</td>
            <td>${r.hours.toFixed(2)}</td>
            <td>${r.amount}</td>
            <td><button class="pdf-btn" onclick="openInvoice(${r.id})">PDF</button></td>
        </tr>`;
    });

    renderPageInfo();
}

function renderPageInfo(){
    const total = filtered.length;
    const start = total ? (page - 1) * rowsPerPage + 1 : 0;
    const end = Math.min(page * rowsPerPage, total);

    document.getElementById("pageInfo").innerText =
        `Showing ${start}â€“${end} of ${total} entries`;

    prevBtn.disabled = page === 1;
    nextBtn.disabled = end >= total;
}

/* SEARCH */
search.addEventListener("input", () => {
    const q = search.value.toLowerCase();
    filtered = data.filter(x =>
        x.arrival.includes(q) ||
        x.delivery.includes(q) ||
        x.amount.toString().includes(q)
    );
    page = 1;
    render();
});

/* FILTER */
function toggleFilter(){
    filterBox.style.display = filterBox.style.display === "block" ? "none" : "block";
}

function applyFilter(){
    const a = arrivalFilter.value;
    const d = deliveryFilter.value;

    filtered = data.filter(x =>
        (!a || x.arrival === a) &&
        (!d || x.delivery === d)
    );
    page = 1;
    render();
    filterBox.style.display = "none";
}

function resetFilter(){
    arrivalFilter.value = "";
    deliveryFilter.value = "";
    filtered = [...data];
    page = 1;
    render();
}

/* PAGINATION */
rowsPerPageSelect = document.getElementById("rowsPerPage");
rowsPerPageSelect.onchange = () => {
    rowsPerPage = Number(rowsPerPageSelect.value);
    page = 1;
    render();
};

prevBtn.onclick = () => { if(page > 1){ page--; render(); } };
nextBtn.onclick = () => { if(page * rowsPerPage < filtered.length){ page++; render(); } };

/* INVOICE */
function openInvoice(id){
    selectedJob = id;
    invoiceModal.style.display = "flex";
}

function confirmInvoice(){
    const d = invoiceDate.value;
    if(!d){ alert("Select invoice date"); return; }
    alert(`Invoice generated for Job ID ${selectedJob} on ${d}`);
    invoiceModal.style.display = "none";
}

window.onclick = e => {
    if(e.target.classList.contains("modal")) e.target.style.display = "none";
};

render();
</script>

</body>
</html>


